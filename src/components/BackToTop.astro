---
const label = "返回顶部";
---

<button
  id="back-to-top"
  type="button"
  class="back-to-top"
  aria-label={label}
  title={label}
>
  ↑
</button>

<script is:inline>
  const button = document.querySelector('#back-to-top');
  const showAfter = 240;

  function onScroll() {
    if (!button) return;
    const shouldShow = window.scrollY > showAfter;
    button.classList.toggle('is-visible', shouldShow);
  }

  function backToTop() {
    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    window.scrollTo({ top: 0, behavior: prefersReducedMotion ? 'auto' : 'smooth' });
  }

  window.addEventListener('scroll', onScroll, { passive: true });
  button?.addEventListener('click', backToTop);
  onScroll();
</script>

<style is:global>
  .back-to-top {
    position: fixed;
    right: 1.5rem;
    bottom: 1.5rem;
    z-index: 40;
    width: 2.5rem;
    height: 2.5rem;
    border-radius: 999px;
    border: 1px solid var(--color-border, rgba(0, 0, 0, 0.15));
    background: var(--color-bg, #ffffff);
    color: var(--color-text-primary, #111111);
    display: grid;
    place-items: center;
    opacity: 0;
    pointer-events: none;
    transform: translateY(8px);
    transition: opacity 0.2s ease, transform 0.2s ease;
  }

  .back-to-top.is-visible {
    opacity: 1;
    pointer-events: auto;
    transform: translateY(0);
  }

  .back-to-top:hover {
    color: var(--color-text-primary, #111111);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
  }

  html.dark .back-to-top {
    background: #1b1b1b;
    border-color: rgba(255, 255, 255, 0.2);
  }
</style>

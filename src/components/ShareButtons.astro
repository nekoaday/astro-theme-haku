---
import themeConfig from "@/config";

interface Props {
  title: string;
  url: string;
}

const { title, url } = Astro.props;
const encodedTitle = encodeURIComponent(title);
const encodedUrl = encodeURIComponent(url);

const { twitter, telegram, linkedin, mastodon } = themeConfig.social;

const shareLinks = [
  {
    label: "Twitter",
    href: `https://twitter.com/intent/tweet?text=${encodedTitle}&url=${encodedUrl}`,
    enabled: true,
  },
  {
    label: "Telegram",
    href: `https://t.me/share/url?url=${encodedUrl}&text=${encodedTitle}`,
    enabled: true,
  },
  {
    label: "LinkedIn",
    href: `https://www.linkedin.com/sharing/share-offsite/?url=${encodedUrl}`,
    enabled: true,
  },
  {
    label: "Mastodon",
    href: mastodon ? `${mastodon}/share?text=${encodedTitle}%20${encodedUrl}` : "",
    enabled: Boolean(mastodon),
  },
].filter((item) => item.enabled);
---

<div class="share" aria-label="分享此文章">
  <span class="share__label">分享</span>
  <div class="share__links">
    {shareLinks.map((item) => (
      <a
        href={item.href}
        target="_blank"
        rel="noopener noreferrer"
        aria-label={`分享到 ${item.label}`}
      >
        {item.label}
      </a>
    ))}
    {telegram && (
      <a
        href={`https://t.me/${telegram}`}
        target="_blank"
        rel="noopener noreferrer"
        aria-label="Telegram"
      >
        {telegram}
      </a>
    )}
    {twitter && (
      <a
        href={`https://twitter.com/${twitter}`}
        target="_blank"
        rel="noopener noreferrer"
        aria-label="Twitter"
      >
        @{twitter}
      </a>
    )}
  </div>
</div>

<style is:global>
  .share {
    margin-top: 2rem;
    display: flex;
    flex-direction: column;
    gap: 0.6rem;
  }

  .share__links {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .share__links a {
    padding: 0.2rem 0.7rem;
    border-radius: 999px;
    border: 1px solid var(--color-border, rgba(0, 0, 0, 0.12));
    text-decoration: none;
  }

  html.dark .share__links a {
    border-color: rgba(255, 255, 255, 0.2);
  }
</style>
